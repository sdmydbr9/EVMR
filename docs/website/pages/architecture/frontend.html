<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frontend Structure - EVMR Documentation</title>
    <link rel="stylesheet" href="../../css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="docs-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="../../images/logo.svg" alt="EVMR Logo" class="logo">
                <h1>EVMR Docs</h1>
            </div>
            <div class="sidebar-search">
                <input type="text" id="search-input" placeholder="Search documentation...">
                <i class="fas fa-search search-icon"></i>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li class="nav-section">
                        <span class="section-title">Getting Started</span>
                        <ul>
                            <li><a href="../../index.html">Introduction</a></li>
                            <li><a href="../quickstart.html">Quick Start Guide</a></li>
                            <li><a href="../installation.html">Installation</a></li>
                        </ul>
                    </li>
                    <li class="nav-section">
                        <span class="section-title">Architecture</span>
                        <ul>
                            <li><a href="overview.html">System Overview</a></li>
                            <li><a href="microservices.html">Microservices</a></li>
                            <li><a href="database.html">Database Schema</a></li>
                            <li><a href="frontend.html" class="active">Frontend Structure</a></li>
                            <li><a href="api-gateway.html">API Gateway</a></li>
                        </ul>
                    </li>
                    <li class="nav-section">
                        <span class="section-title">Microservices</span>
                        <ul>
                            <li><a href="../microservices/auth-service.html">Auth Service</a></li>
                            <li><a href="../microservices/patient-service.html">Patient Service</a></li>
                            <li><a href="../microservices/appointment-service.html">Appointment Service</a></li>
                            <li><a href="../microservices/inventory-service.html">Inventory Service</a></li>
                            <li><a href="../microservices/reporting-service.html">Reporting Service</a></li>
                            <li><a href="../microservices/notification-service.html">Notification Service</a></li>
                        </ul>
                    </li>
                    <li class="nav-section">
                        <span class="section-title">API Reference</span>
                        <ul>
                            <li><a href="../api/authentication.html">Authentication</a></li>
                            <li><a href="../api/patients.html">Patients</a></li>
                            <li><a href="../api/medical-records.html">Medical Records</a></li>
                            <li><a href="../api/appointments.html">Appointments</a></li>
                            <li><a href="../api/inventory.html">Inventory</a></li>
                            <li><a href="../api/reports.html">Reports</a></li>
                        </ul>
                    </li>
                    <li class="nav-section">
                        <span class="section-title">Deployment</span>
                        <ul>
                            <li><a href="../deployment/docker.html">Docker Deployment</a></li>
                            <li><a href="../deployment/configuration.html">Configuration</a></li>
                            <li><a href="../deployment/scaling.html">Scaling</a></li>
                            <li><a href="../deployment/monitoring.html">Monitoring</a></li>
                        </ul>
                    </li>
                    <li class="nav-section">
                        <span class="section-title">Guides</span>
                        <ul>
                            <li><a href="../guides/user-management.html">User Management</a></li>
                            <li><a href="../guides/patient-records.html">Patient Records</a></li>
                            <li><a href="../guides/appointments.html">Appointments</a></li>
                            <li><a href="../guides/reporting.html">Reporting</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="https://github.com/yourusername/EVMR" target="_blank">
                    <i class="fab fa-github"></i> GitHub
                </a>
                <a href="../contributing.html">
                    <i class="fas fa-code-branch"></i> Contributing
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-header">
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="header-links">
                    <a href="https://github.com/yourusername/EVMR" target="_blank">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="#" id="theme-toggle">
                        <i class="fas fa-moon"></i>
                    </a>
                </div>
            </div>

            <div class="content-body">
                <h1>Frontend Structure</h1>
                <p class="lead">
                    The EVMR frontend is built with React.js and Material UI, providing a modern, responsive user interface for veterinary practice management.
                </p>

                <nav class="page-toc">
                    <h3>On this page</h3>
                    <ul>
                        <li><a href="#overview">Overview</a></li>
                        <li><a href="#tech-stack">Technology Stack</a></li>
                        <li><a href="#architecture">Architecture</a></li>
                        <li><a href="#folder-structure">Folder Structure</a></li>
                        <li><a href="#component-hierarchy">Component Hierarchy</a></li>
                        <li><a href="#state-management">State Management</a></li>
                        <li><a href="#routing">Routing</a></li>
                        <li><a href="#api-integration">API Integration</a></li>
                        <li><a href="#theming">Theming and Styling</a></li>
                        <li><a href="#authentication">Authentication Flow</a></li>
                        <li><a href="#performance">Performance Optimizations</a></li>
                    </ul>
                </nav>

                <h2 id="overview">Overview</h2>
                <p>
                    The EVMR frontend is a single-page application (SPA) built with React.js that provides a comprehensive user interface for veterinary practice management. It communicates with the backend microservices through the API Gateway and offers a responsive, intuitive experience for veterinarians, technicians, and administrative staff.
                </p>

                <div class="frontend-diagram">
                    <img src="../../images/frontend-architecture.png" alt="EVMR Frontend Architecture">
                    <p class="diagram-caption">Figure 1: Frontend architecture showing component organization and data flow</p>
                </div>

                <h2 id="tech-stack">Technology Stack</h2>
                <p>
                    The frontend is built using the following technologies:
                </p>

                <div class="tech-stack-grid">
                    <div class="tech-card">
                        <div class="tech-icon">
                            <i class="fab fa-react"></i>
                        </div>
                        <div class="tech-details">
                            <h3>React.js</h3>
                            <p>JavaScript library for building user interfaces</p>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">
                            <i class="fas fa-palette"></i>
                        </div>
                        <div class="tech-details">
                            <h3>Material UI</h3>
                            <p>React component library implementing Material Design</p>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">
                            <i class="fas fa-route"></i>
                        </div>
                        <div class="tech-details">
                            <h3>React Router</h3>
                            <p>Declarative routing for React applications</p>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="tech-details">
                            <h3>Redux Toolkit</h3>
                            <p>State management library for React</p>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <div class="tech-details">
                            <h3>Axios</h3>
                            <p>Promise-based HTTP client for API requests</p>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="tech-details">
                            <h3>FullCalendar</h3>
                            <p>Calendar component for appointment scheduling</p>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div class="tech-details">
                            <h3>Chart.js</h3>
                            <p>JavaScript charting library for data visualization</p>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="tech-details">
                            <h3>Formik & Yup</h3>
                            <p>Form handling and validation libraries</p>
                        </div>
                    </div>
                </div>

                <h2 id="architecture">Architecture</h2>
                <p>
                    The frontend follows a component-based architecture with a clear separation of concerns:
                </p>

                <ul>
                    <li><strong>Presentation Layer:</strong> React components that render the UI</li>
                    <li><strong>State Management Layer:</strong> Redux store and slices for managing application state</li>
                    <li><strong>Service Layer:</strong> API services for communication with the backend</li>
                    <li><strong>Utility Layer:</strong> Helper functions and utilities</li>
                </ul>

                <p>
                    This architecture promotes reusability, maintainability, and testability by keeping components focused on specific responsibilities.
                </p>

                <h2 id="folder-structure">Folder Structure</h2>
                <p>
                    The frontend codebase is organized into the following directory structure:
                </p>

                <div class="code-block">
                    <pre><code>frontend/
├── public/               # Static assets and index.html
├── src/                  # Source code
│   ├── assets/           # Images, fonts, and other static assets
│   ├── components/       # Reusable UI components
│   │   ├── common/       # Common components used across the app
│   │   ├── layout/       # Layout components (header, sidebar, etc.)
│   │   ├── patients/     # Patient-related components
│   │   ├── appointments/ # Appointment-related components
│   │   ├── inventory/    # Inventory-related components
│   │   └── reports/      # Reporting components
│   ├── pages/            # Page components for each route
│   ├── features/         # Redux Toolkit slices and related logic
│   ├── services/         # API services for backend communication
│   ├── hooks/            # Custom React hooks
│   ├── utils/            # Utility functions and helpers
│   ├── constants/        # Application constants
│   ├── theme/            # Material UI theme configuration
│   ├── routes/           # Route definitions
│   ├── store/            # Redux store configuration
│   ├── App.js            # Root component
│   └── index.js          # Entry point
├── .env                  # Environment variables
├── package.json          # Dependencies and scripts
└── README.md             # Documentation</code></pre>
                </div>

                <h2 id="component-hierarchy">Component Hierarchy</h2>
                <p>
                    The frontend is organized into a hierarchy of components:
                </p>

                <div class="component-hierarchy-diagram">
                    <img src="../../images/component-hierarchy.png" alt="EVMR Component Hierarchy">
                    <p class="diagram-caption">Figure 2: Component hierarchy showing parent-child relationships</p>
                </div>

                <h3>Key Components</h3>
                <ul>
                    <li><strong>App:</strong> Root component that sets up routing and global providers</li>
                    <li><strong>Layout:</strong> Defines the overall page structure with header, sidebar, and content area</li>
                    <li><strong>AuthGuard:</strong> Protects routes that require authentication</li>
                    <li><strong>Dashboard:</strong> Main dashboard with summary widgets and quick actions</li>
                    <li><strong>PatientList:</strong> Displays a list of patients with filtering and search</li>
                    <li><strong>PatientDetails:</strong> Shows detailed patient information and medical history</li>
                    <li><strong>AppointmentCalendar:</strong> Calendar view for scheduling and managing appointments</li>
                    <li><strong>InventoryManager:</strong> Interface for managing inventory items</li>
                    <li><strong>ReportGenerator:</strong> Tools for generating and viewing reports</li>
                </ul>

                <h2 id="state-management">State Management</h2>
                <p>
                    The frontend uses Redux Toolkit for state management, organizing the store into slices for different domains:
                </p>

                <div class="code-block">
                    <pre><code>// Example Redux slice for authentication
import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';
import authService from '../services/authService';

export const login = createAsyncThunk(
  'auth/login',
  async (credentials, { rejectWithValue }) => {
    try {
      const response = await authService.login(credentials);
      return response.data;
    } catch (error) {
      return rejectWithValue(error.response.data);
    }
  }
);

const authSlice = createSlice({
  name: 'auth',
  initialState: {
    user: null,
    token: localStorage.getItem('token'),
    isAuthenticated: !!localStorage.getItem('token'),
    loading: false,
    error: null
  },
  reducers: {
    logout: (state) => {
      localStorage.removeItem('token');
      state.user = null;
      state.token = null;
      state.isAuthenticated = false;
    }
  },
  extraReducers: (builder) => {
    builder
      .addCase(login.pending, (state) => {
        state.loading = true;
        state.error = null;
      })
      .addCase(login.fulfilled, (state, action) => {
        state.loading = false;
        state.user = action.payload.user;
        state.token = action.payload.token;
        state.isAuthenticated = true;
        localStorage.setItem('token', action.payload.token);
      })
      .addCase(login.rejected, (state, action) => {
        state.loading = false;
        state.error = action.payload;
      });
  }
});

export const { logout } = authSlice.actions;
export default authSlice.reducer;</code></pre>
                </div>

                <h3>State Organization</h3>
                <p>
                    The Redux store is organized into the following slices:
                </p>
                <ul>
                    <li><strong>auth:</strong> Authentication state (user, token, etc.)</li>
                    <li><strong>patients:</strong> Patient data and related state</li>
                    <li><strong>appointments:</strong> Appointment data and calendar state</li>
                    <li><strong>inventory:</strong> Inventory items and stock levels</li>
                    <li><strong>reports:</strong> Report configurations and data</li>
                    <li><strong>ui:</strong> UI-related state (theme, sidebar, notifications)</li>
                </ul>

                <h2 id="routing">Routing</h2>
                <p>
                    The frontend uses React Router for navigation between different sections of the application:
                </p>

                <div class="code-block">
                    <pre><code>// Example routing configuration
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import { useSelector } from 'react-redux';
import Layout from './components/layout/Layout';
import AuthGuard from './components/auth/AuthGuard';
import Login from './pages/Login';
import Dashboard from './pages/Dashboard';
import PatientList from './pages/patients/PatientList';
import PatientDetails from './pages/patients/PatientDetails';
import AppointmentCalendar from './pages/appointments/AppointmentCalendar';
import InventoryManager from './pages/inventory/InventoryManager';
import ReportGenerator from './pages/reports/ReportGenerator';

const AppRoutes = () => {
  const { isAuthenticated } = useSelector((state) => state.auth);

  return (
    <BrowserRouter>
      <Routes>
        <Route path="/login" element={<Login />} />
        
        <Route element={<AuthGuard />}>
          <Route element={<Layout />}>
            <Route path="/" element={<Navigate to="/dashboard" replace />} />
            <Route path="/dashboard" element={<Dashboard />} />
            <Route path="/patients" element={<PatientList />} />
            <Route path="/patients/:id" element={<PatientDetails />} />
            <Route path="/appointments" element={<AppointmentCalendar />} />
            <Route path="/inventory" element={<InventoryManager />} />
            <Route path="/reports" element={<ReportGenerator />} />
          </Route>
        </Route>
        
        <Route path="*" element={<Navigate to={isAuthenticated ? "/dashboard" : "/login"} replace />} />
      </Routes>
    </BrowserRouter>
  );
};</code></pre>
                </div>

                <h2 id="api-integration">API Integration</h2>
                <p>
                    The frontend communicates with the backend microservices through the API Gateway using Axios:
                </p>

                <div class="code-block">
                    <pre><code>// Example API service for patients
import axios from 'axios';

const API_URL = process.env.REACT_APP_API_URL;

// Create axios instance with default config
const apiClient = axios.create({
  baseURL: API_URL,
  headers: {
    'Content-Type': 'application/json'
  }
});

// Add request interceptor for authentication
apiClient.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);

// Add response interceptor for error handling
apiClient.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response && error.response.status === 401) {
      // Handle unauthorized access (e.g., redirect to login)
      localStorage.removeItem('token');
      window.location.href = '/login';
    }
    return Promise.reject(error);
  }
);

const patientService = {
  getPatients: (params) => apiClient.get('/api/patients', { params }),
  getPatientById: (id) => apiClient.get(`/api/patients/${id}`),
  createPatient: (data) => apiClient.post('/api/patients', data),
  updatePatient: (id, data) => apiClient.put(`/api/patients/${id}`, data),
  deletePatient: (id) => apiClient.delete(`/api/patients/${id}`),
  getMedicalRecords: (patientId) => apiClient.get(`/api/medical-records/patient/${patientId}`)
};

export default patientService;</code></pre>
                </div>

                <h2 id="theming">Theming and Styling</h2>
                <p>
                    The frontend uses Material UI's theming system for consistent styling across the application:
                </p>

                <div class="code-block">
                    <pre><code>// Theme configuration
import { createTheme } from '@mui/material/styles';

const lightTheme = createTheme({
  palette: {
    mode: 'light',
    primary: {
      main: '#4263eb',
      light: '#748ffc',
      dark: '#364fc7',
      contrastText: '#ffffff'
    },
    secondary: {
      main: '#15aabf',
      light: '#22b8cf',
      dark: '#1098ad',
      contrastText: '#ffffff'
    },
    background: {
      default: '#f8f9fa',
      paper: '#ffffff'
    },
    text: {
      primary: '#212529',
      secondary: '#495057'
    }
  },
  typography: {
    fontFamily: '"Inter", "Roboto", "Helvetica", "Arial", sans-serif',
    h1: {
      fontWeight: 600,
      fontSize: '2.5rem'
    },
    h2: {
      fontWeight: 600,
      fontSize: '2rem'
    },
    h3: {
      fontWeight: 600,
      fontSize: '1.75rem'
    },
    h4: {
      fontWeight: 600,
      fontSize: '1.5rem'
    },
    h5: {
      fontWeight: 600,
      fontSize: '1.25rem'
    },
    h6: {
      fontWeight: 600,
      fontSize: '1rem'
    }
  },
  shape: {
    borderRadius: 8
  },
  components: {
    MuiButton: {
      styleOverrides: {
        root: {
          textTransform: 'none',
          fontWeight: 500
        }
      }
    },
    MuiCard: {
      styleOverrides: {
        root: {
          boxShadow: '0 2px 8px rgba(0, 0, 0, 0.05)'
        }
      }
    }
  }
});

const darkTheme = createTheme({
  palette: {
    mode: 'dark',
    primary: {
      main: '#748ffc',
      light: '#91a7ff',
      dark: '#5c7cfa',
      contrastText: '#ffffff'
    },
    secondary: {
      main: '#22b8cf',
      light: '#3bc9db',
      dark: '#15aabf',
      contrastText: '#ffffff'
    },
    background: {
      default: '#212529',
      paper: '#343a40'
    },
    text: {
      primary: '#f8f9fa',
      secondary: '#dee2e6'
    }
  },
  // Other theme settings remain the same
});

export { lightTheme, darkTheme };</code></pre>
                </div>

                <h2 id="authentication">Authentication Flow</h2>
                <p>
                    The frontend implements a JWT-based authentication flow:
                </p>

                <div class="auth-flow-diagram">
                    <img src="../../images/auth-flow.png" alt="EVMR Authentication Flow">
                    <p class="diagram-caption">Figure 3: Authentication flow showing login, token storage, and protected routes</p>
                </div>

                <ol>
                    <li>User enters credentials on the login page</li>
                    <li>Credentials are sent to the Auth Service via the API Gateway</li>
                    <li>Upon successful authentication, the server returns a JWT token</li>
                    <li>The token is stored in localStorage and added to the Redux store</li>
                    <li>Subsequent API requests include the token in the Authorization header</li>
                    <li>Protected routes are wrapped with an AuthGuard component that checks for authentication</li>
                    <li>When the token expires or the user logs out, the token is removed and the user is redirected to the login page</li>
                </ol>

                <h2 id="performance">Performance Optimizations</h2>
                <p>
                    The frontend implements several performance optimizations:
                </p>

                <ul>
                    <li><strong>Code Splitting:</strong> Using React.lazy and Suspense to load components on demand</li>
                    <li><strong>Memoization:</strong> Using React.memo, useMemo, and useCallback to prevent unnecessary re-renders</li>
                    <li><strong>Virtualization:</strong> Using react-window for efficiently rendering large lists</li>
                    <li><strong>Image Optimization:</strong> Properly sized and compressed images with lazy loading</li>
                    <li><strong>Bundle Size Optimization:</strong> Tree shaking and selective imports from libraries</li>
                    <li><strong>Caching:</strong> Implementing client-side caching for frequently accessed data</li>
                </ul>

                <div class="code-block">
                    <pre><code>// Example of code splitting with React.lazy
import React, { lazy, Suspense } from 'react';
import { CircularProgress } from '@mui/material';

// Lazy-loaded components
const Dashboard = lazy(() => import('./pages/Dashboard'));
const PatientList = lazy(() => import('./pages/patients/PatientList'));
const PatientDetails = lazy(() => import('./pages/patients/PatientDetails'));

// Loading fallback
const LoadingFallback = () => (
  <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100vh' }}>
    <CircularProgress />
  </div>
);

// Routes with lazy loading
const AppRoutes = () => (
  <Suspense fallback={<LoadingFallback />}>
    <Routes>
      <Route path="/dashboard" element={<Dashboard />} />
      <Route path="/patients" element={<PatientList />} />
      <Route path="/patients/:id" element={<PatientDetails />} />
      {/* Other routes */}
    </Routes>
  </Suspense>
);</code></pre>
                </div>

                <div class="next-section">
                    <h3>Next Steps</h3>
                    <p>Now that you understand the frontend structure, you can explore:</p>
                    <ul>
                        <li><a href="api-gateway.html">API Gateway Documentation</a></li>
                        <li><a href="../guides/user-management.html">User Management Guide</a></li>
                        <li><a href="../guides/patient-records.html">Patient Records Guide</a></li>
                    </ul>
                </div>
            </div>

            <footer class="content-footer">
                <p>&copy; 2023 EVMR Documentation. All rights reserved.</p>
                <p>
                    <a href="../privacy.html">Privacy Policy</a> |
                    <a href="../terms.html">Terms of Service</a> |
                    <a href="../contact.html">Contact</a>
                </p>
            </footer>
        </main>
    </div>

    <script src="../../js/main.js"></script>
</body>
</html>
